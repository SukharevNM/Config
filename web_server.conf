% Конфигурация веб-сервера
(def MAX_CONNECTIONS 1000);
(def DEFAULT_PORT 80);
(def PORT_OFFSET 443);
(def SSL_PORT {+ DEFAULT_PORT PORT_OFFSET});
(def ADMIN_EMAIL "admin@example.com");
(def LOG_LEVEL "debug");
(def MAX_BODY_SIZE { * 1024 1024 }); % 1MB

([
    server: ([
        port: DEFAULT_PORT,
        ssl: ([
            port: SSL_PORT,
            certificate: "/etc/ssl/cert.pem"
        ]),
        timeouts: ([
            read: 30,
            write: {+ 10 20},
            keep_alive: { * 5 2 }
        ])
    ]),

    limits: ([
        max_connections: MAX_CONNECTIONS,
        max_body_size: MAX_BODY_SIZE,
        rate_limit: array(100, 200, 300)
    ]),

    logging: ([
        level: LOG_LEVEL,
        path: "/var/log/server.log",
        retention: {/ 365 7} % недель в году
    ]),

    admins: array(
        ([
            name: "John Doe",
            email: ADMIN_EMAIL,
            permissions: array("read", "write", "delete")
        ]),
        ([
            name: "Jane Smith",
            email: "jane@example.com",
            permissions: array("read", "write")
        ])
    ),

    status_page: ([
        path: "/status",
        secret_key: {chr 65} % 'A'
    ])
])